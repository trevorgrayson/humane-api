#!/bin/bash

PROJ_DIR="$PROJECTS/$1"

if [ -d $PROJ_DIR ]; then
  cd /tmp
  mkdir -p dsky
  cd dsky

  if [ -d $1 ]; then
    echo 'project cached'
  else 
    git clone $PROJ_DIR
  fi

  cd $1

  # TODO need to be able to specify if PROJECT dir, or temp dir
  case "$2" in
  "github" )
      cd $PROJ_DIR
      xdg-open "http://github.com/`cat .git/config | grep url | cut -d: -f2 | cut -d. -f1`"
      ;;
  "stat" )
      cd $PROJ_DIR
      # tc build 
      # github prs
      git diff
      git diff --stat
      echo "pull requests"
      dsky $1 pr
      ;;
  "pr" )
      cd $PROJ_DIR
      hub pr list -s open -L 10 --format="%i %au: %t %uI%n" # TODO needs formatting
      ;;
  "prc" )
      cd $PROJ_DIR
      hub pr checkout $3
      ;;
  "vi" )
      cd $PROJ_DIR
      vi
      ;;
  "commit" )
      cd $PROJ_DIR
      git add .
      git commit
      ;;
  "push" )
      cd $PROJ_DIR
      git push origin
      ;;
  "co" )
      git checkout $3
      ;;
  "branch" )
      git branch
      ;;
  * )
      cd $PROJ_DIR
      make $3
      ;;
  esac

else 
  # not a local ~/project 
  echo "SUBJECT $1 not found."
fi

